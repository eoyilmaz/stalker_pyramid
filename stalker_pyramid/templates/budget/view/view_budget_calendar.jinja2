{# Stalker Pyramid a Web Base Production Asset Management System
 Copyright (C) 2009-2014 Erkan Ozgur Yilmaz

 This file is part of Stalker Pyramid.

 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Lesser General Public
 License as published by the Free Software Foundation;
 version 2.1 of the License.

 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Lesser General Public License for more details.

 You should have received a copy of the GNU Lesser General Public
 License along with this library; if not, write to the Free Software
 Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
#}


{% extends "base.jinja2" %}

{% block pre_header %}
    <link rel="stylesheet"
          href='{{ request.static_url("stalker_pyramid:static/codebase/dhtmlxgantt.css") }}'/>
{% endblock pre_header %}

{# BREADCRUMBS #}
{% block breadcrumbs %}
    {% include 'breadcrumb/breadcrumbs.jinja2' %}
{% endblock breadcrumbs %}

{#SIDEBAR#}
{% block sidebar %}
    {% include 'sidebar.jinja2' %}
{% endblock sidebar %}

{#PAGE-CONTENT#}
{% block page_content %}

{#    {% set page_title=entity.name %}#}
{#    {% include 'page_header.jinja2' %}#}

    <div class="space-6"></div>
    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="widget-box transparent invoice-box">
                <div class="widget-header widget-header-large">
                    {% set client=entity.project.client %}
                    {% include 'client/view/client_card.jinja2' %}
                    <h3 class="grey lighter pull-left position-relative">
                        {{  entity.project.client.name }}
                    </h3>

                    <div class="widget-toolbar no-border invoice-info">
                        <span class="invoice-info-label">Bugdet:</span>
                        <span class="red">{{ entity.name }}</span>
                        <br />
                        <span class="invoice-info-label">Date:</span>
                        <span class="blue">{{ entity.date_updated }}</span>
                    </div>

                    <div class="widget-toolbar hidden-480">
                        <a href="#">
                            <i class="icon-print"></i>
                        </a>
                    </div>
                </div>

                <div class="widget-body">
                    <div class="widget-main padding-24">

                        <div class="row-fluid">
                            <div id="gantt_here" style='width:100%; height:300px;'></div>
                        </div>
                        <div class="space"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock page_content %}

{% block extrascripts %}
    <script type="text/javascript">
        if("ontouchend" in document) document.write("<script src='{{ request.static_url("stalker_pyramid:static/ace/js/jquery.mobile.custom.min.js") }}'>"+"<"+"/script>");
    </script>
    <script src='{{ request.static_url("stalker_pyramid:static/jqGrid/js/i18n/grid.locale-en.js") }}'></script>
    <script src='{{ request.static_url("stalker_pyramid:static/jqGrid/js/jquery.jqGrid.js") }}'></script>
    <script src='{{ request.static_url("stalker_pyramid:static/stalker/js/accounting.min.js") }}'></script>
    <script src='{{ request.static_url("stalker_pyramid:static/codebase/dhtmlxgantt.js") }}'></script>

    <script type="text/javascript">
        $(document).ready(function () {

             var tasks =  {
                data:[
                    {id:1, text:"Project #2", start_date:"01-04-2015", duration:18,order:10,
                        progress:0.4, open: true},
                    {id:2, text:"Task #1", 	  start_date:"02-04-2015", duration:8, order:10,
                        progress:0.6, parent:1},
                    {id:3, text:"Task #2",    start_date:"11-04-2015", duration:8, order:20,
                        progress:0.6, parent:1}
                ],
                links:[
                    { id:1, source:1, target:2, type:"1"},
                    { id:2, source:2, target:3, type:"0"},
                    { id:3, source:3, target:4, type:"0"},
                    { id:4, source:2, target:5, type:"2"}
                ]
            };

            gantt.init("gantt_here");
            gantt.parse(tasks);

            gantt.attachEvent("onTaskOpened", function(id, e) {
                alert("You've just clicked an item with id="+id);
            });


        });
    </script>
{% endblock extrascripts %}
