

{# ***************************************************************************************#}
{# Table Template#}

{% raw %}
<script id="tmpl_version_table" type="text/x-dot-template">
    <div class="span12">
        <div class="widget-container-span">
            <div class="widget-box">
                <div class="widget-header widget-header-small header-color-{{=it.table_title_color }}">
                    <h4 class="smaller">
                        <i class="icon-list"></i>
                        {{=it.table_title }}
                    </h4>

                    <div class="widget-toolbar">
                        <a href="#" data-action="collapse">
                            <i class="icon-chevron-down"></i>
                        </a>
                    </div>
                </div>
                <div class="widget-body">
                    <div class="widget-main no-padding">
                        <div id="{{=it.table_spinner_id }}"
                             class="well well-sm">

                            <div class="inline middle blue bigger-110"><i
                                    class="icon-spinner icon-spin orange bigger-125"></i>
                                Loading
                                content...
                            </div>
                        </div>

                        <table id="{{=it.table_id }}"
                               class="table table-striped table-bordered table-hover hide"
                                >
                            <thead>
                                <tr>
                                    <th>Parent Name</th>
                                    <th>Task Name</th>
                                    <th>#</th>
                                    <th>Is Published</th>
                                    <th>Name</th>
                                    <th>Path</th>
                                    <th>Created By</th>
                                </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
{% endraw %}

{# ***************************************************************************************#}
{# Task Row Template#}

{% raw %}
<script id="tmpl_versionRow" type="text/x-dot-template">

    <tr>
        <td>{{=it.parent_name }}</td>
        <td>{{=it.name }}</td>
        <td>{{=it.id }}</td>
        <td>{{=it.is_published }}</td>
        <td>{{=it.name }}</td>
        <td>{{=it.absolute_full_path }}</td>
        <td>
            <a href="">{{=it.created_by_name}}</a>
        </td>
    </tr>
</script>
{% endraw %}



{# ***************************************************************************************#}
{# Table Creation#}

<script>

    // fill projects table with dynamic data
    $(document).ready(function () {
        var loadTableData = function (address, tableId, spinnerId) {

            $.getJSON(address).then(function (data) {

                var version_template = doT.template($('#tmpl_versionRow').html());

                // wait until document is ready
                $(function () {
                    var i;
                    var table_body = $('#' + tableId + '>tbody');

                    for (i = 0; i < data.length; i++) {

                        // append it to the table


                        table_body.append(version_template(data[i]));
                    }

                    var oTable1 = $('#' + tableId).dataTable();

                });
                $('#' + tableId).show();
                $('#' + spinnerId).hide();


            });


        }

        var table_template = doT.template($('#tmpl_version_table').html());
        $('#version_table_row').append(table_template({'table_title_color': 'red', 'table_title': 'Versions', 'table_id': 'versions', 'table_spinner_id': 'loading_spinner_for_versions'}));

        loadTableData('/tasks/{{ task.id }}/versions/', 'versions', 'loading_spinner_for_versions');
    });

</script>
