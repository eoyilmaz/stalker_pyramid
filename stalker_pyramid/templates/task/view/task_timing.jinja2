<div class="widget-box">
    <div class="widget-header widget-header-flat widget-header-small">
          <h5>
                <i class="icon-time"></i>
                Timing
          </h5>
    </div>

    <div class="widget-body no-padding">
        <div class="widget-main no-padding">
            <div id='bid_alert' class="alert alert-block no-padding" >

                <table class="table">
                    <tbody>
                        <tr>
                            <td style="text-align: right"><strong>Bid</strong></td>
                            <td><span id="bid"></span></td>
                        </tr>
                        <tr>
                            <td style="text-align: right"><strong>Schedule Timing</strong></td>
                            <td><span id="schedule_timing"></span></td>
                        </tr>
                        <tr>
                            <td style="text-align: right"><strong>Total Time Logs</strong></td>
                            <td><span id="total_logged"></span></td>
                        </tr>
                        <tr>
                            <td style="text-align: right"><strong>Time to Complete</strong></td>
                            <td><span id="time_to_complete"></span></td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div><!--/widget-main-->
        {% if (entity.schedule_seconds - entity.total_logged_seconds)==0  and entity.status.code=='WIP'%}
        <div class="widget-toolbox clearfix">
            <button id='task_review_button'
                    class="btn btn-small btn-danger span12"
                    data-placement="bottom"
                    title="Request Extra Time"
                    data-target="#dialog_template"
                    data-toggle="modal"
                    data-keyboard="false"
                    href="/tasks/{{entity.id}}/request_extra_time/dialog?came_from={{request.current_route_path() }}"
                    >
                <i class="icon-time bigger-130"></i> Request Extra Time</button>
        </div>
        {% endif %}
    </div><!--/widget-body-->
</div><!--/widget-box-->

<script class="code" type="text/javascript">
    $(document).ready(function () {


        var schedule_unit_seconds = unit_by_seconds('{{ entity.schedule_unit }}')

        var bid_seconds = calculate_seconds({{ entity.bid_timing }}, '{{ entity.bid_unit }}')
        var schedule_timing_seconds ={{ entity.schedule_seconds}};
        var total_logged_seconds ={{ entity.total_logged_seconds}};

        console.log('entity.bid_unit: {{ entity.bid_unit }} total_logged_seconds: '+total_logged_seconds+' schedule_timing_seconds: '+schedule_timing_seconds+' bid_seconds:'+bid_seconds)

        var bid = meaningful_time_calculator(bid_seconds, '{{ entity.bid_unit }}')
        var schedule_timing = meaningful_time_calculator(schedule_timing_seconds, '{{ entity.bid_unit }}');
        var total_logged = meaningful_time_calculator(total_logged_seconds, '{{ entity.bid_unit }}');
        var time_to_complete = meaningful_time_calculator(schedule_timing_seconds-total_logged_seconds, '{{ entity.bid_unit }}');

        $('#bid').text(bid);
        $('#schedule_timing').text(schedule_timing);
        $('#total_logged').text(total_logged);
        $('#time_to_complete').text(time_to_complete);

        if(bid_seconds < total_logged_seconds)
        {
            $('#bid_alert').addClass('alert-danger')
        }
        else{
             $('#bid_alert').addClass('alert-info')
        }
    });
</script>